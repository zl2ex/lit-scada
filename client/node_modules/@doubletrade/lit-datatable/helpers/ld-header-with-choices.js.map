{"version":3,"file":"ld-header-with-choices.js","sourceRoot":"","sources":["ld-header-with-choices.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  LitElement, css, html, PropertyValues, TemplateResult\n} from 'lit';\nimport { property, customElement, query } from 'lit/decorators.js';\nimport '@polymer/paper-icon-button/paper-icon-button';\nimport '@polymer/paper-item/paper-icon-item';\nimport '@polymer/paper-item/paper-item-body';\nimport '@polymer/iron-icons/iron-icons';\n\nimport { ironFlexLayoutAlignTheme, ironFlexLayoutTheme } from '../iron-flex-import';\nimport './ld-header-with-sort';\n\nexport interface Choice {\n  key: string;\n  label: string;\n  style?: string;\n  icon?: string;\n  iconStyle?: string;\n  prefix?: TemplateResult;\n}\n\n@customElement('ld-header-with-choices')\nexport class LdHeaderWithChoices extends LitElement {\n  @property({ type: Array }) choices: Array<Choice> = [];\n\n  @property({ type: Boolean }) enableFilter = false;\n\n  @property({ type: String }) filterValue = '';\n\n  @query('#filterInput') filterInput!: HTMLInputElement;\n\n  @property({ type: Array }) filteredChoices: Array<Choice> = [];\n\n  @property({ type: Array }) selectedChoices: Array<string> = [];\n\n  @property({ type: String }) property = '';\n\n  @property({ type: Boolean }) opened = false;\n\n  @query('.dropdown') dropdown!: HTMLDivElement;\n\n  static get styles() {\n    const main = css`\n      :host {\n        display: block;\n      }\n\n      .dropdown {\n        position: fixed;\n        background: var(--ld-header-with-choices-background-color, white);\n        transform-origin: 50% 0;\n        transition: transform 0.1s;\n        transform: scaleY(1);\n        box-shadow: var(--ld-header-with-choices-box-shadown, 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24));\n        width: var(--dt-dropdown-choice-dropdown-width, max-content);\n        z-index: 99;\n        max-height: 300px;\n        overflow: auto;\n        margin: var(--dt-dropdown-choice-dropdown-margin, 0);\n        color: var(--primary-text-color, black);\n        border-radius: var(--dt-dropdown-choice-dropdown-border-radius, 0);\n        box-shadow: var(--dt-dropdown-choice-dropdown-box-shadow, 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24));\n      }\n\n      .dropdown.hide {\n        transform: scaleY(0);\n      }\n\n      paper-icon-button[icon=\"check-box\"] {\n        min-width: 40px;\n        color: var(--paper-datatable-api-checked-checkbox-color, --primary-color);\n      }\n\n      paper-icon-button[icon=\"check-box-outline-blank\"] {\n        min-width: 40px;\n        color: var(--paper-datatable-api-unchecked-checkbox-color, --primary-text-color);\n      }\n\n      .selected {\n        color: var(--primary-color, #1E73BE);\n        font-style: italic;\n        margin-left: 4px;\n      }\n\n      .choice-icon {\n        margin-left: 24px;\n      }\n\n      .label {\n        font-size: 13px;\n        font-family: Roboto;\n        font-weight: 400;\n        margin-right: 16px;\n      }\n\n      .prefix {\n        margin-right: 10px;\n      }\n\n      paper-icon-button {\n        --paper-icon-button: {\n          color: var(--paper-icon-button-color);\n          transition: color 0.3s;\n        }\n\n        --paper-icon-button-hover: {\n          color: var(--paper-icon-button-color-hover);\n        }\n      }\n\n      #search-container {\n        padding: 6px 6px 6px 10px;\n        border-bottom: 1px solid #E0E0E0;\n      }\n\n      #search-container input{\n          border: none;\n          font-size: var(--header-filter-input-font-size, 16px);\n          width: calc(100% - 30px);\n          outline: none;\n          background: transparent;\n          height: 24px;\n          padding: 0;\n          color: var(--dt-input-text-color, black);\n          box-shadow: none;\n          min-width: 0;\n      }\n      #search-container input:-webkit-autofill,\n      input:-webkit-autofill:hover,\n      input:-webkit-autofill:focus,\n      input:-webkit-autofill:active {\n        -webkit-box-shadow: 0 0 0 30px white inset !important;\n      }\n    `;\n    return [main, ironFlexLayoutTheme, ironFlexLayoutAlignTheme];\n  }\n\n  render() {\n    return html`\n      <div class=\"layout horizontal center\">\n      \n        <div class=\"layout horizontal center\">\n          <span class=\"flex layout horizontal\">\n            <slot></slot>\n            ${this.selectedChoices && this.selectedChoices.length > 0 ? html`\n            <div class=\"selected\">\n              ${this.countSelected(this.selectedChoices)}\n            </div>` : null}\n          </span>\n          <paper-icon-button icon=\"arrow-drop-down\" @tap=\"${this.openDropdown.bind(this)}\"></paper-icon-button>\n        </div>\n      \n        <div class=\"dropdown\">\n          ${this.enableFilter ? html`\n            <div id=\"search-container\">\n              <input id=\"filterInput\"\n                @input=${this.filterValueChanged.bind(this)}\n                @change=${this.filterValueChanged.bind(this)} \n                .value=\"${this.filterValue}\" />\n              <iron-icon icon=\"icons:search\"></iron-icon>\n            </div>\n          ` : null}\n          ${this.filteredChoices && this.filteredChoices.map((choice) => html`\n            <div class=\"layout horizontal center\" @tap=\"${this.tapChoice.bind(this, choice.key)}\">\n              <paper-icon-button icon=\"${this.computeIconName(choice.key, this.selectedChoices)}\">\n              </paper-icon-button>\n              ${choice.prefix ? html`<div class=\"prefix\">${choice.prefix}</div>` : null}\n              <div class=\"label\" .style=\"${choice.style}\">\n                ${choice.label}\n              </div>\n              ${choice.icon ? html`\n                <iron-icon class=\"choice-icon\" .style=\"${choice.iconStyle}\" icon=\"${choice.icon}\"></iron-icon>\n              ` : null}\n            </div>\n          `)}\n        </div>\n      \n      </div>\n  `;\n  }\n\n  static get properties() {\n    return {\n    };\n  }\n\n  constructor() {\n    super();\n    this.selectedChoices = [];\n    this.opened = false;\n  }\n\n  computeIconName(choice: string, selectedChoices: Array<string>) {\n    if (selectedChoices.indexOf(choice) === -1) {\n      return 'check-box-outline-blank';\n    }\n    return 'check-box';\n  }\n\n  countSelected(selectedChoices: Array<string>) {\n    return selectedChoices.length > 0 ? ` (${selectedChoices.length})` : '';\n  }\n\n  tapChoice(name: string) {\n    const selectedChoices = [...this.selectedChoices];\n    const indexOfChoice = selectedChoices.indexOf(name);\n    if (indexOfChoice === -1) {\n      selectedChoices.push(name);\n    } else {\n      selectedChoices.splice(indexOfChoice, 1);\n    }\n    this.dispatchEvent(new CustomEvent(\n      'selected-choices-changed',\n      { detail: { value: selectedChoices, property: this.property } }\n    ));\n  }\n\n  updated(properties: PropertyValues<LdHeaderWithChoices>) {\n    if (properties.has('opened')) {\n      if (this.opened) {\n        this.dropdown.classList.remove('hide');\n        if (this.enableFilter) {\n          this.filterInput.focus();\n          this.filterValue = '';\n        }\n      } else {\n        this.dropdown.classList.add('hide');\n      }\n      this.fitToBorder();\n    }\n    if (properties.has('enableFilter') || properties.has('choices') || properties.has('filterValue')) {\n      this.updateFilteredChoices();\n    }\n  }\n\n  openDropdown() {\n    this.opened = !this.opened;\n  }\n\n  fitToBorder() {\n    if (this.shadowRoot) {\n      if (this.dropdown) {\n        this.dropdown.style.left = '0';\n        const dropdownWidth = this.dropdown.offsetWidth;\n        const viewPortWidth = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n        const thisX = this.getBoundingClientRect().x;\n        const thisY = this.getBoundingClientRect().y;\n        if ((dropdownWidth + thisX) > viewPortWidth) {\n          this.dropdown.style.left = `${viewPortWidth - dropdownWidth}px`;\n        } else {\n          this.dropdown.style.left = `${thisX}px`;\n        }\n        this.dropdown.style.top = `${thisY + this.offsetHeight + 9}px`;\n      }\n    }\n  }\n\n  firstUpdated() {\n    window.addEventListener('resize', () => {\n      this.fitToBorder();\n    });\n    window.addEventListener('keyup', (event) => {\n      if (this.opened && event.key === 'Escape') {\n        this.opened = false;\n      }\n    });\n    window.addEventListener('click', (event) => {\n      const path = event.composedPath && event.composedPath();\n      if (path.includes(this)) {\n        event.preventDefault();\n      } else if (this.opened) {\n        this.opened = false;\n      }\n    });\n  }\n\n  filterValueChanged(event: InputEvent) {\n    event.stopPropagation();\n    const target = event.target as HTMLInputElement;\n    this.filterValue = target.value;\n  }\n\n  updateFilteredChoices() {\n    this.filteredChoices = (this.enableFilter && this.choices)\n      ? this.choices.filter((c) => c?.label?.toLowerCase().includes(this.filterValue?.toLowerCase()))\n      : this.choices;\n  }\n}\n"]}